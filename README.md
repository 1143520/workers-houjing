# 喉镜压力测试系统

这是一个基于 PyQt5 开发的喉镜压力测试系统，用于实时监测和记录喉镜操作过程中的压力数据。系统支持实时数据采集、可视化显示和数据导出功能。

## 系统功能

- 实时数据采集：同时支持多达16个传感器的压力数据采集
- 图表可视化：实时显示三个传感器的压力数据曲线
- 数据导出：支持将测试数据导出为Excel格式
- 用户认证：基于用户名和密码的安全登录系统
- 串口通信：支持实际串口和虚拟串口通信
- 报警功能：支持压力阈值报警

## 技术特点

- 前端界面：使用PyQt5构建现代化界面
- 数据可视化：使用Matplotlib实现实时数据曲线显示
- 串口通信：支持PySerial串口通信
- 数据处理：支持数据实时处理和统计分析
- 多线程处理：采用QThread确保UI响应性

## 开发环境配置

### 系统要求
- Python 3.8+
- Windows 10/11
- VSPD (Virtual Serial Port Driver)
- 友善串口调试助手
- 稳定的串口连接

### 依赖安装
1. 克隆项目到本地：
```bash
git clone [repository-url]
cd pressure-test-system
```

2. 创建并激活虚拟环境：
```bash
python -m venv venv
.\venv\Scripts\activate
```

3. 安装依赖：
```bash
pip install -r requirements.txt
```

### 虚拟串口配置

#### VSPD 安装和配置
1. 从 `tools/VSPD` 目录安装 VSPD
2. 运行 VSPD 管理工具
3. 创建虚拟串口对（如 COM1-COM2）
4. 确保串口对已启用

#### 友善串口调试助手
1. 从 `tools/SerialDebugger` 目录运行友善串口调试助手
2. 用于测试和调试串口通信
3. 可以模拟发送传感器数据

### 运行程序
1. 确保虚拟串口已正确配置
2. 运行主程序：
```bash
python main.py
```

3. 登录系统：
   - 用户名：航小北
   - 密码：buaa

### 项目结构
```
pressure-test-system/
├── main.py              # 登录界面入口
├── main_system.py       # 系统主界面和核心功能
├── InterfaceUI.py       # 界面UI定义
├── serial_simulator.py  # 串口模拟器
├── requirements.txt     # 项目依赖
├── README.md           # 项目说明
├── tools/              # 工具软件
│   ├── VSPD/          # 虚拟串口驱动
│   └── SerialDebugger/ # 友善串口调试助手
└── icons/              # UI图标资源
```

## 使用说明

### 1. 系统登录
- 运行 main.py 启动登录界面
- 使用指定的用户名和密码登录系统
- 登录成功后自动进入主界面

### 2. 串口配置
- 安装并运行 VSPD
- 创建虚拟串口对（COM1-COM2）
- 在系统中选择正确的串口和波特率（默认115200）

### 3. 数据采集
- 选择需要监测的传感器（1-16号）
- 填写患者信息
- 设置报警阈值（默认500）
- 点击"开始"按钮开始记录数据
- 数据会实时显示在右侧三个图表中

### 4. 数据导出
- 点击"保存数据"按钮
- 选择保存位置
- 系统自动生成Excel文件，包含：
  - 患者信息
  - 传感器数据
  - 统计分析结果

## 调试说明

### 使用串口模拟器
1. 运行 serial_simulator.py：
```bash
python serial_simulator.py
```
2. 选择一个虚拟串口（建议COM1）
3. 模拟器会自动生成随机数据

### 使用友善串口调试助手
1. 打开友善串口调试助手
2. 选择另一个虚拟串口（建议COM2）
3. 设置波特率为115200
4. 可以发送自定义数据进行测试

## 注意事项

1. 首次运行前必须安装 VSPD
2. 确保虚拟串口对正确创建并启用
3. 数据采集时避免关闭程序
4. 建议定期导出数据
5. 使用管理员权限运行程序以确保串口访问

## 常见问题解决

1. 串口连接失败
   - 检查 VSPD 是否正确安装和运行
   - 确认串口未被其他程序占用
   - 以管理员身份运行程序

2. 数据显示异常
   - 检查波特率设置
   - 确认数据格式是否正确
   - 重启程序和虚拟串口

## 技术支持

如有任何问题或建议，请联系系统管理员或开发团队。

## 开发团队

本系统由清华大学薛拳皇支持开发。``` 